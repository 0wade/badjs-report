var BJ_REPORT=function(a){if(a.BJ_REPORT)return a.BJ_REPORT;var b=[],c=a.onerror;a.onerror=function(d,e,f,g,h){var i=d;h&&h.stack&&(i=l._processStackMsg(h)),b.push({msg:i,target:e,rowNum:f,colNum:g}),k(),c&&c.apply(a,arguments)};var d={id:0,uin:0,url:"",combo:1,level:4,ignore:[],delay:100,submit:null},e=function(a,b){return Object.prototype.toString.call(a)==="[object "+(b||"Object")+"]"},f=function(a,b){var c=[],f=[],g=[];if(e(a)){a.level=a.level||d.level;for(var h in a){var i=a[h]||"";if(i){if(e(i))try{i=JSON.stringify(i)}catch(j){i="[BJ_REPORT detect value stringify error] "+j.toString()}g.push(h+":"+i),c.push(h+"="+encodeURIComponent(i)),f.push(h+"["+b+"]="+encodeURIComponent(i))}}}return[f.join("&"),g.join(","),c.join("&")]},g=[],h=function(a){if(d.submit)d.submit(a);else{var b=new Image;g.push(b),b.src=a}},i=[],j=0,k=function(a){if(d.report){for(;b.length;){for(var c=!1,g=b.shift(),k=f(g,i.length),l=0,m=d.ignore.length;m>l;l++){var n=d.ignore[l];if(e(n,"RegExp")&&n.test(k[1])||e(n,"Function")&&n(g,k[1])){c=!0;break}}c||(d.combo?i.push(k[0]):h(d.report+k[2]+"&_t="+ +new Date),d.onReport&&d.onReport(d.id,g))}var o=i.length;if(o){var p=function(){clearTimeout(j),h(d.report+i.join("&")+"&count="+o+"&_t="+ +new Date),j=0,i=[]};a?p():j||(j=setTimeout(p,d.delay))}}},l={push:function(a){return b.push(e(a)?a:{msg:a}),k(),l},report:function(a){return a&&l.push(a),k(!0),l},init:function(a){if(e(a))for(var b in a)d[b]=a[b];var c=parseInt(d.id,10);return c&&(d.report=(d.url||"http://badjs2.qq.com/badjs")+"?id="+c+"&uin="+parseInt(d.uin||(document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10)+"&from="+encodeURIComponent(location.href)+"&"),l},__onerror__:a.onerror,_processStackMsg:function(a){var b=a.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,5).join("@").replace(/\?[^:]+/gi,""),c=a.toString();return b.indexOf(c)<0&&(b=c+"@"+b),b}};return l}(window);"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=BJ_REPORT),exports.BJ_REPORT=BJ_REPORT),function(a){if(a.BJ_REPORT){var b=function(b){try{if(b.stack){var c=b.stack.match("http://[^\n]+");c=c?c[0]:"";var d=c.match(":([0-9]+):([0-9]+)");d||(d=[0,0,0]);var e=a.BJ_REPORT._processStackMsg(b);a.BJ_REPORT.report({msg:e,rowNum:d[1],colNum:d[2],target:c.replace(d[0],"")})}else a.BJ_REPORT.report(b)}catch(f){a.BJ_REPORT.report(b)}},c=a.BJ_REPORT.tryJs=function(a){return a&&(b=a),c},d=function(a,b){var c;for(c in b)a[c]=b[c]},e=function(a){return"function"==typeof a},f=function(c,d){return function(){try{return c.apply(this,d||arguments)}catch(e){try{return c.apply(this,d||arguments)}catch(f){b(f),f.stack&&console&&console.error&&console.error("[BJ-REPORT]",e.stack);var g=a.onerror;throw a.onerror=function(){},setTimeout(function(){a.onerror=g},50),f}}}},g=function(a){return function(){for(var b,c=[],d=0,g=arguments.length;g>d;d++)b=arguments[d],e(b)&&(b=f(b)),c.push(b);return a.apply(this,c)}},h=function(a){return function(b,c){if("string"==typeof b)try{b=new Function(b)}catch(d){throw d}var e=[].slice.call(arguments,2);return b=f(b,e.length&&e),a(b,c)}},i=function(a,b){return function(){for(var c,d,g=[],h=0,i=arguments.length;i>h;h++)c=arguments[h],e(c)&&(d=f(c))&&(c.tryWrap=d)&&(c=d),g.push(c);return a.apply(b||this,g)}},j=function(a){var b,c;for(b in a)c=a[b],e(c)&&(a[b]=f(c));return a};c.spyJquery=function(){var b=a.$;if(!b||!b.event)return c;var d=b.event.add,f=b.ajax,g=b.event.remove;return d&&(b.event.add=i(d),b.event.remove=function(){for(var a,b=[],c=0,d=arguments.length;d>c;c++)a=arguments[c],e(a)&&(a=a.tryWrap),b.push(a);return g.apply(this,b)}),f&&(b.ajax=function(a,c){return c||(c=a,a=void 0),j(c),a?f.call(b,a,c):f.call(b,c)}),c},c.spyModules=function(){var b=a.require,h=a.define;return h&&h.amd&&b&&(a.require=g(b),d(a.require,b),a.define=g(h),d(a.define,h)),a.seajs&&h&&(a.define=function(){for(var a,b=[],c=0,d=arguments.length;d>c;c++)a=arguments[c],e(a)&&(a=f(a),a.toString=function(a){return function(){return a.toString()}}(arguments[c])),b.push(a);return h.apply(this,b)},d(a.define,h)),c},c.spySystem=function(){return a.setTimeout=h(a.setTimeout),a.setInterval=h(a.setInterval),c},c.spyCustom=function(a){return e(a)?f(a):j(a)},c.spyAll=function(){return c.spyJquery().spyModules().spySystem(),c}}}(window);