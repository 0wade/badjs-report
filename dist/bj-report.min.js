var BJ_REPORT=function(a){if(a.BJ_REPORT)return a.BJ_REPORT;var b=[],c={id:0,uin:0,url:"",combo:1,ext:{},level:4,ignore:[],random:1,delay:1e3,submit:null},d=function(a,b){return Object.prototype.toString.call(a)==="[object "+(b||"Object")+"]"},e=function(a){var b=typeof a;return"object"===b&&!!a},f=a.onerror;a.onerror=function(b,c,e,g,i){var j=b;i&&i.stack&&(j=h(i)),d(j,"Event")&&(j+=j.type?"--"+j.type+"--"+(j.target?j.target.tagName+"::"+j.target.src:""):""),o.push({msg:j,target:c,rowNum:e,colNum:g}),n(),f&&f.apply(a,arguments)};var g=function(a){try{if(a.stack){var b=a.stack.match("http://[^\n]+");b=b?b[0]:"";var c=b.match(":([0-9]+):([0-9]+)");c||(c=[0,0,0]);var d=h(a);return{msg:d,rowNum:c[1],colNum:c[2],target:b.replace(c[0],"")}}return a}catch(e){return a}},h=function(a){var b=a.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,5).join("@").replace(/\?[^:]+/gi,""),c=a.toString();return b.indexOf(c)<0&&(b=c+"@"+b),b},i=function(a,b){var d=[],f=[],g=[];if(e(a)){a.level=a.level||c.level;for(var h in a){var i=a[h]||"";if(i){if(e(i))try{i=JSON.stringify(i)}catch(j){i="[BJ_REPORT detect value stringify error] "+j.toString()}g.push(h+":"+i),d.push(h+"="+encodeURIComponent(i)),f.push(h+"["+b+"]="+encodeURIComponent(i))}}}return[f.join("&"),g.join(","),d.join("&")]},j=[],k=function(a){if(c.submit)c.submit(a);else{var b=new Image;j.push(b),b.src=a}},l=[],m=0,n=function(a){if(c.report){for(;b.length;){var e=!1,f=b.shift(),g=i(f,l.length);if(d(c.ignore,"Array"))for(var h=0,j=c.ignore.length;j>h;h++){var n=c.ignore[h];if(d(n,"RegExp")&&n.test(g[1])||d(n,"Function")&&n(f,g[1])){e=!0;break}}e||(c.combo?l.push(g[0]):k(c.report+g[2]+"&_t="+ +new Date),c.onReport&&c.onReport(c.id,f))}var o=l.length;if(o){var p=function(){clearTimeout(m),k(c.report+l.join("&")+"&count="+o+"&_t="+ +new Date),m=0,l=[]};a?p():m||(m=setTimeout(p,c.delay))}}},o={push:function(a){return Math.random()>=c.random?o:(b.push(e(a)?g(a):{msg:a}),n(),o)},report:function(a){return a&&o.push(a),n(!0),o},info:function(a){return a?(e(a)?a.level=2:a={msg:a,level:2},o.push(a),o):o},debug:function(a){return a?(e(a)?a.level=1:a={msg:a,level:1},o.push(a),o):o},init:function(a){if(e(a))for(var b in a)c[b]=a[b];var d=parseInt(c.id,10);return d&&(c.report=(c.url||"http://badjs2.qq.com/badjs")+"?id="+d+"&uin="+parseInt(c.uin||(document.cookie.match(/\buin=\D+(\d+)/)||[])[1],10)+"&from="+encodeURIComponent(location.href)+"&ext="+JSON.stringify(c.ext)+"&"),o},__onerror__:a.onerror};return"undefined"!=typeof console&&console.error&&setTimeout(function(){console.error("BJ_ERROR",decodeURIComponent(((location.hash||"").match(/([#&])BJ_ERROR=([^&$]+)/)||[])[2]).replace(/(:\d+:\d+)\s*/g,"$1\n"))},0),o}(window);"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(exports=module.exports=BJ_REPORT),exports.BJ_REPORT=BJ_REPORT);