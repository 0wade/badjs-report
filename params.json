{"name":"Badjs-report","tagline":"monitor error and report ","body":"# BJ_REPORT\r\n\r\n# Installation\r\n``` javascript\r\nnpm install badjs-report\r\n```\r\n``` javascript\r\nbower install https://github.com/BetterJS/report.git\r\n```\r\n\r\n\r\n\r\n## Getting Started\r\n> badjs-report 必须在所有类库之前加载并初始化。\r\n\r\n##### 初始化\r\n``` javascript\r\nBJ_REPORT.init({\r\n  id: 1                                   // 不指定id将不上报\r\n});\r\n```\r\n##### 配置说明\r\n``` javascript\r\nBJ_REPORT.init({\r\n  id: 1,                                // 不指定id将不上报\r\n  uin: 123,                             // 指定用户 number , 默认已经读取 qq uin\r\n  combo:0,\t\t\t\t\t\t\t\t// combo 是否合并上报， 0 关闭， 1 启动（默认）\r\n  delay:1000, \t\t\t\t\t\t\t// 当 combo= 1 可用，延迟多少毫秒，合并缓冲区中的上报\r\n  url: \"http://badjs2.qq.com/badjs\",    // 指定上报地址\r\n  ignore: [/Script error/i],            // 忽略某个错误\r\n  level: 4, // 设置默认的级别             // 上报等级   // 1-debug 2-info 4-error\r\n  target : \"xxxx.js\"                    //  错误来源的js\r\n  random : 1                            // 抽样上报，1~0 之间数值，  1为100%上报\r\n  onReport : function (id , errObj){    // 当上报的时候回调 。 id: 上报的id , errObj : 错误的对象\r\n  ext : {}                              // 扩展属性，后端做扩展处理属性。例如：存在 msid 就会分发到 monitor.server.com\r\n\r\n  }\r\n});\r\n```\r\nBJ_Report 是重写了 window.onerror 进行上报的，无需编写任何捕获错误的代码\r\n<br/>\r\n#####  手动上报\r\n``` javascript\r\nBJ_REPORT.report(\"error msg\");\r\n\r\nBJ_REPORT.report({\r\n  msg: \"xx load error\",                 // 错误信息\r\n  target: \"xxx.js\",                     // 错误的来源js\r\n  rowNum: 100,                          // 错误的行数\r\n  colNum: 100,                          // 错误的列数\r\n});\r\n\r\ntry{\r\n    // something throw error ...\r\n}catch(error){\r\n    BJ_REPORT.report(e);\r\n}\r\n```\r\n<br/>\r\n#####  延迟上报\r\n``` javascript\r\nBJ_REPORT.push(\"error msg\");\r\n\r\nBJ_REPORT.push({\r\n  msg: \"xx load error\",                 // 错误信息\r\n  target: \"xxx.js\",                     // 错误的来源js\r\n  rowNum: 100,                          // 错误的行数\r\n  colNum: 100,                          // 错误的列数\r\n});\r\n\r\nBJ_REPORT.report();\r\n\r\n```\r\n当 combo = 1 时候的， 调用 report ，根据缓冲池中的数据一条条上报;<br/>\r\n当 combo = 0 时候的， 会延迟 delay 毫秒，再合并上报\r\n<br/>\r\n#####  可以链式调用\r\n``` javascript\r\nBJ_REPORT.init({id: 1}).push(\"error msg\").report(\"error msg 2\");\r\n```\r\n\r\n#####  info 上报\r\n``` javascript\r\nBJ_REPORT.info(\"info\"); // 用户记录日志\r\n```\r\n\r\n#####  debug 上报\r\n``` javascript\r\nBJ_REPORT.debug(\"debug\");  //可以结合实时上报，跟踪问题\r\n```\r\n<br/>\r\n<br/>\r\n### 高级用法\r\n>script error  的错误，怎么解决？  [#3](https://github.com/BetterJS/badjs-report/issues/3)\r\n\r\n由于 BJ_Report 只是重写了onerror 方法而已，而且浏览器的跨域问题不能获得外链 javascript 的错误，所以使用tryJs  进行包裹。\r\n#### 包裹jquery\r\n``` javascript\r\nBJ_REPORT.tryJs().spyJquery();\r\n```\r\n包裹 jquery 的 event.add , event.remove , event.ajax 这几个异步方法。\r\n<br/>\r\n<br/>\r\n#### 包裹 define , require\r\n``` javascript\r\nBJ_REPORT.tryJs().spyModules();\r\n```\r\n包裹 模块化框架 的 define , require 方法\r\n<br/>\r\n<br/>\r\n#### 包裹  js 默认的方法\r\n``` javascript\r\nBJ_REPORT.tryJs().spySystem();\r\n```\r\n包裹 js 的 setTimeout , setInterval 方法\r\n<br/>\r\n<br/>\r\n#### 包裹 自定义的方法\r\n``` javascript\r\nvar customFunction = function (){};\r\ncustomFunction  = BJ_REPORT.tryJs().spyCustom(customFunction );\r\n\r\n// 只会包裹 customOne  , customTwo\r\nvar customObject = { customOne : function (){} , customTwo : function (){} , customVar : 1}\r\nBJ_REPORT.tryJs().spyCustom(customObject );\r\n```\r\n包裹 自定义的方法或则对象\r\n<br/>\r\n<br/>\r\n#### 运行所有默认的包裹\r\n``` javascript\r\n//自动运行 SpyJquery , SpyModule , SpySystem\r\nBJ_REPORT.tryJs().spyAll();\r\n```\r\n\r\n\r\n## update log\r\n##### v1.1.5\r\n1. bugfix\r\n\r\n\r\n##### v1.1.4\r\n1. 增加info 和 debug 接口\r\n2. report 增加对 error 对象处理\r\n3. 处理 [Object event] 问题\r\n\r\n##### v1.1.3\r\n1. bugfix\r\n\r\n##### v1.1.2\r\n1. 增加抽样参数 random\r\n\r\n##### v1.1.1\r\n1. seajs 兼容的BUG修复\r\n2. 增加 ext 属性，用户可以自己定义里面的值上报\r\n\r\n##### v1.1.0\r\n1. 增加对seajs 模块化的包裹\r\n2. 增加对IE下面的错误的上报\r\n\r\n##### v1.0.5\r\n1. 修复异步环境下抛给浏览器的BUG也会上报，\r\n2. 修复ignore 数组判断的迭代的问题\r\n\r\n##### v1.0.4\r\n1. 修复 spy 插件增加在 异步环境中，抛出异常捕获后，再抛给浏览器\r\n2. 修复 增加在异步环境中，抛出异常，捕获后，将错误信息输出\r\n3. 增加onReport 回调\r\n\r\n##### v1.0.3\r\n1. 修复说明文档\r\n\r\n##### v1.0.2\r\n1. 修复 uin 的正则\r\n\r\n##### v1.0.1\r\n1. 增加 spy 插件\r\n\r\n##### v1.0.0\r\n1. 功能上线\r\n\r\n\r\n\r\n\r\n","google":"","note":"Don't delete this file! It's used internally to help with page regeneration."}